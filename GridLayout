import 'package:flutter/material.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Icon Grid',
      debugShowCheckedModeBanner: false,
      theme: ThemeData(primarySwatch: Colors.blue, useMaterial3: true),
      home: const IconGridScreen(),
    );
  }
}

class IconGridScreen extends StatefulWidget {
  const IconGridScreen({super.key});

  @override
  State<IconGridScreen> createState() => _IconGridScreenState();
}

class _IconGridScreenState extends State<IconGridScreen> {
  // Constants
  static const double borderWidth = 2.0;
  static const double iconSize = 40.0;
  static const Color borderColor = Colors.black;
  
  // Color options for cycling through
  final List<Color> colorOptions = [
    Colors.amber,
    Colors.red,
    Colors.green,
    Colors.blue,
    Colors.purple,
    Colors.orange,
  ];
  
  late Map<int, Color> iconColors = {};
  int colorIndex = 0;

  // Icon grid data
  final List<List<IconData>> iconRows = [
    [Icons.person, Icons.settings],
    [Icons.favorite, Icons.star, Icons.notifications],
    [Icons.home],
    [Icons.camera_alt, Icons.email],
    [Icons.music_note, Icons.cloud, Icons.map, Icons.phone],
    [Icons.lock, Icons.public],
  ];

  @override
  void initState() {
    super.initState();
    // Initialize all icons with default color
    int iconIndex = 0;
    for (var row in iconRows) {
      for (var _ in row) {
        iconColors[iconIndex] = colorOptions[0];
        iconIndex++;
      } 
    }
  }

  void _cycleColor(int iconIndex) {
    setState(() {
      int currentColorIndex = colorOptions.indexOf(iconColors[iconIndex]!);
      iconColors[iconIndex] = colorOptions[(currentColorIndex + 1) % colorOptions.length];
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('Icon Grid'),
        centerTitle: true,
      ),
      body: SafeArea(
        child: Container(
          decoration: BoxDecoration(
            border: Border.all(color: borderColor, width: borderWidth),
          ),
          child: Column(
            children: List.generate(iconRows.length, (rowIndex) {
              return buildRow(
                icons: iconRows[rowIndex],
                rowIndex: rowIndex,
                totalRows: iconRows.length,
              );
            }),
          ),
        ),
      ),
    );
  }

  /// Reusable row builder with proper borders
  Widget buildRow({
    required List<IconData> icons,
    required int rowIndex,
    required int totalRows,
  }) {
    int startIconIndex = iconRows.sublist(0, rowIndex).fold(0, (sum, row) => sum + row.length);

    return Expanded(
      child: Row(
        children: List.generate(icons.length, (colIndex) {
          final int iconIndex = startIconIndex + colIndex;
          final bool isLastColumn = colIndex == icons.length - 1;
          final bool isLastRow = rowIndex == totalRows - 1;

          return Expanded(
            child: GestureDetector(
              onTap: () => _cycleColor(iconIndex),
              child: Container(
                decoration: BoxDecoration(
                  color: Colors.grey[50],
                  border: Border(
                    right: !isLastColumn
                        ? BorderSide(color: borderColor, width: borderWidth)
                        : BorderSide.none,
                    bottom: !isLastRow
                        ? BorderSide(color: borderColor, width: borderWidth)
                        : BorderSide.none,
                  ),
                ),
                child: Center(
                  child: Column(
                    mainAxisAlignment: MainAxisAlignment.center,
                    children: [
                      Icon(
                        icons[colIndex],
                        size: iconSize,
                        color: iconColors[iconIndex],
                      ),
                      const SizedBox(height: 4),
                      Text(
                        'Tap to change',
                        style: TextStyle(
                          fontSize: 10,
                          color: Colors.grey[600],
                        ),
                      ),
                    ],
                  ),
                ),
              ),
            ),
          );
        }),
      ),
    );
  }
}
